X = [0 0 0 1;1 1 0 1;2 -1 0 1;3 0 0 1];
% X = X * [1 0 0 0;0 cos(90) sin(90) 0;0 -sin(90) cos(90) 0;0 0 0 1 ];
c21=sqrt((X(2,1)-X(1,1))^2+(X(2,2)-X(1,2))^2+(X(2,3)-X(1,3))^2);
c32=sqrt((X(3,1)-X(2,1))^2+(X(3,2)-X(2,2))^2+(X(3,3)-X(2,3))^2);
c43=sqrt((X(4,1)-X(3,1))^2+(X(4,2)-X(3,2))^2+(X(4,3)-X(3,3))^2);
alfa=c21/(c32+c21);beta=c32/(c43+c32);
B=[X(1,1) X(1,2) X(1,3);X(2,1) X(2,2) X(2,3);X(3,1) X(3,2) X(3,3);X(4,1) X(4,2) X(4,3)];
P(1,:)=nahaste_par(alfa,beta,0,8,B);
P(2,:)=nahaste_par(alfa,beta,1,8,B);
P(3,:)=nahaste_par(alfa,beta,2,8,B);
P(4,:)=nahaste_par(alfa,beta,3,8,B);
P(5,:)=nahaste_par(alfa,beta,4,8,B);
P(6,:)=nahaste_par(alfa,beta,5,8,B);
P(7,:)=nahaste_par(alfa,beta,6,8,B);
P(8,:)=nahaste_par(alfa,beta,7,8,B);
P(9,:)=nahaste_par(alfa,beta,8,8,B);
% subplot(1,2,1);
X1=[P(1,1) P(2,1)];Y1=[P(1,2) P(2,2)];Z1=[P(1,3) P(2,3)];line(X1,Y1,Z1,'Color','red','LineStyle','--');
X1=[P(2,1) P(3,1)];Y1=[P(2,2) P(3,2)];Z1=[P(2,3) P(3,3)];line(X1,Y1,Z1,'Color','red','LineStyle','--');
X1=[P(3,1) P(4,1)];Y1=[P(3,2) P(4,2)];Z1=[P(3,3) P(4,3)];line(X1,Y1,Z1,'Color','red','LineStyle','--');
X1=[P(4,1) P(5,1)];Y1=[P(4,2) P(5,2)];Z1=[P(4,3) P(5,3)];line(X1,Y1,Z1,'Color','red','LineStyle','--');
X1=[P(5,1) P(6,1)];Y1=[P(5,2) P(6,2)];Z1=[P(5,3) P(6,3)];line(X1,Y1,Z1,'Color','red','LineStyle','--');
X1=[P(6,1) P(7,1)];Y1=[P(6,2) P(7,2)];Z1=[P(6,3) P(7,3)];line(X1,Y1,Z1,'Color','red','LineStyle','--');
X1=[P(7,1) P(8,1)];Y1=[P(7,2) P(8,2)];Z1=[P(7,3) P(8,3)];line(X1,Y1,Z1,'Color','red','LineStyle','--');
X1=[P(8,1) P(9,1)];Y1=[P(8,2) P(9,2)];Z1=[P(8,3) P(9,3)];line(X1,Y1,Z1,'Color','red','LineStyle','--');
view(3);hold on;
% xlim([min(X(:,1))-1 max(X(:,1))+1]);ylim([min(X(:,2))-1 max(X(:,2))+1]);zlim([min(X(:,3))-1 max(X(:,3))+1]);
xlabel('x');ylabel('y');zlabel('z');
XP = X;
for i=0:35
	XP = XP * [1 0 0 0;0 1 0 0;0 0 1 0;5 0 0 1]*[1 0 0 0;0 cos(3.1416) sin(3.1416) 0;0 -sin(3.1416) cos(3.1416) 0;0 0 0 1 ];
	c21=sqrt((XP(2,1)-XP(1,1))^2+(XP(2,2)-XP(1,2))^2+(XP(2,3)-XP(1,3))^2);
    c32=sqrt((XP(3,1)-XP(2,1))^2+(XP(3,2)-XP(2,2))^2+(XP(3,3)-XP(2,3))^2);
    c43=sqrt((XP(4,1)-XP(3,1))^2+(XP(4,2)-XP(3,2))^2+(XP(4,3)-XP(3,3))^2);
    alfa=c21/(c32+c21);beta=c32/(c43+c32);
	B=[XP(1,1) XP(1,2) XP(1,3);XP(2,1) XP(2,2) XP(2,3);XP(3,1) XP(3,2) XP(3,3);XP(4,1) XP(4,2) XP(4,3)];
	P(1,:)=nahaste_par(alfa,beta,0,8,B);
	P(2,:)=nahaste_par(alfa,beta,1,8,B);
	P(3,:)=nahaste_par(alfa,beta,2,8,B);
	P(4,:)=nahaste_par(alfa,beta,3,8,B);
	P(5,:)=nahaste_par(alfa,beta,4,8,B);
	P(6,:)=nahaste_par(alfa,beta,5,8,B);
	P(7,:)=nahaste_par(alfa,beta,6,8,B);
	P(8,:)=nahaste_par(alfa,beta,7,8,B);
	P(9,:)=nahaste_par(alfa,beta,8,8,B);
	X1=[P(1,1) P(2,1)];Y1=[P(1,2) P(2,2)];Z1=[P(1,3) P(2,3)];line(X1,Y1,Z1);
    X1=[P(2,1) P(3,1)];Y1=[P(2,2) P(3,2)];Z1=[P(2,3) P(3,3)];line(X1,Y1,Z1);
    X1=[P(3,1) P(4,1)];Y1=[P(3,2) P(4,2)];Z1=[P(3,3) P(4,3)];line(X1,Y1,Z1);
    X1=[P(4,1) P(5,1)];Y1=[P(4,2) P(5,2)];Z1=[P(4,3) P(5,3)];line(X1,Y1,Z1);
    X1=[P(5,1) P(6,1)];Y1=[P(5,2) P(6,2)];Z1=[P(5,3) P(6,3)];line(X1,Y1,Z1);
    X1=[P(6,1) P(7,1)];Y1=[P(6,2) P(7,2)];Z1=[P(6,3) P(7,3)];line(X1,Y1,Z1);
    X1=[P(7,1) P(8,1)];Y1=[P(7,2) P(8,2)];Z1=[P(7,3) P(8,3)];line(X1,Y1,Z1);
    X1=[P(8,1) P(9,1)];Y1=[P(8,2) P(9,2)];Z1=[P(8,3) P(9,3)];line(X1,Y1,Z1);
end
